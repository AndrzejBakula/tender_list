{% extends "base.html" %}
{% load static %}

{% block title %} Dodaj Wyniki Przetargu {% endblock %}

{% block content %}

<div class="d-flex flex-column align-items-center" style="height: 100%; width: 100%;">
    <div class="d-flex flex-row justify-content-center align-items-center">
        <h2 class="display-5 align-self-center header2"><i>Dodaj Wyniki Przetargu</i></h2>
    </div>

    <div class="d-flex flex-column align-items-center">
        <table class="table table-striped table-bordered">
            <tbody>
                <tr>
                    <th scope="col">Nazwa projektu</th>
                    <td scope="col">{{ tender.project.project_name }}</td>
                </tr>
                <tr>
                    <th scope="col">Kwota zamawiającego</th>
                    <td scope="col">
                        {% if tender.investor_budget %}
                            {{ tender.investor_budget }} zł brutto
                        {% else %}
                            nieokreślono
                        {% endif %}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <table class="table-responsive-xl table-striped table-bordered" style="width: 100%;">
        <thead>
            <tr>
                <th scope="col" style="text-align: center;">Oferent</th>
                <th scope="col" style="text-align: center;">Cena</th>
                {% if tender.is_guarantee %}
                <th scope="col" style="text-align: center;">Gwarancja</th>
                {% endif %}
                {% if tender.is_deadline %}
                <th scope="col" style="text-align: center;">Termin</th>
                {% endif %}
                {% for i in tender.other_criteria.all %}
                <th scope="col" style="text-align: center;">{{ i.criteria_name }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for i in tender.tenderer.all|dictsort:"offer_value" %}
            <tr>
                <td scope="col" style="text-align: center;">
                    <a href="{% url 'company-details' i.tenderer.id %}">{{ i.tenderer.company_name }}</a>
                    <a href="{% url 'delete-tenderer' project.id tender.id i.id %}">(usuń)</a>
                </td>
                <td scope="col" style="text-align: center;">{{ i.offer_value }}</td>
                {% if i.offer_guarantee %}
                <td scope="col" style="text-align: center;">{{ i.offer_guarantee }} mies.</td>
                {% endif %}
                {% if i.offer_deadline %}
                <td scope="col" style="text-align: center;">{{ i.offer_deadline }}</td>
                {% endif %}
                {% for j in i.other_criteria.all %}
                <td scope="col" style="text-align: center;">{{ j.criteria_value }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <hr>
    <div class="d-flex flex-row justify-content-center align-items-center">
        <h3 class="display-5 align-self-center header2"><i>Dodaj Ofertę</i></h3>
    </div>
    <form class="d-flex flex-column justify-content-center align-items-center" style="height: 100%; width: 100%;"
        action="{% url 'add-tender-details' project.id tender.id %}" method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" id="submit">Dodaj</button>
    </form>
    <hr>
    <div class="d-flex flex-row justify-content-center align-items-center" style="padding-left: 0.5%;">
        <a href="{% url 'tender-details' project.id tender.id %}" class="btn btn-outline-primary m-1">Zakończ dodawanie oferentów</a>
    </div>
    
</div>

{% endblock %}